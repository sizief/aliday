<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Ballena Alegre — Viewer</title>
    <link rel="stylesheet" href="../photo.css">
  </head>
  <body>
    <div class="viewport">
      <img id="photo" src="" alt="">
    </div>
    <div class="nav prev"><a id="prevLink" class="disabled">Prev</a></div>
    <div class="center"><span id="counter"></span></div>
    <div class="nav next"><a id="nextLink">Next</a></div>

    <div class="footer">
      <a href="/photos/">Back to Photos</a> · © Ali Deishidi
    </div>

    <script>
      (function() {
        var imageIds = ["1","2","3","4","5","6","7","8","9","10","11"];
        var imgEl = document.getElementById('photo');
        var prevEl = document.getElementById('prevLink');
        var nextEl = document.getElementById('nextLink');
        var counterEl = document.getElementById('counter');

        function getIndexFromHash() {
          var id = (location.hash || '').replace('#','').trim();
          var idx = imageIds.indexOf(id);
          return idx >= 0 ? idx : 0;
        }

        function setAnchor(el, targetIndex) {
          if (targetIndex < 0 || targetIndex >= imageIds.length) {
            el.classList.add('disabled');
            el.removeAttribute('href');
            return;
          }
          el.classList.remove('disabled');
          el.setAttribute('href', '#' + imageIds[targetIndex]);
        }

        function render(index) {
          var id = imageIds[index];
          var baseOptim = '../../assets/images/ballena-alegre-optimized/';
          var baseOrig = '../../assets/images/ballena%20alegre/';
          var triedFallback = false;

          function setOptim() {
            imgEl.src = baseOptim + id + '.jpg';
          }

          imgEl.onerror = function() {
            if (!triedFallback) {
              triedFallback = true;
              imgEl.onerror = null;
              imgEl.src = baseOrig + id + '.JPG';
            }
          };

          setOptim();
          imgEl.setAttribute('alt', 'Ballena Alegre — ' + id);
          document.title = 'Ballena Alegre — ' + id;

          setAnchor(prevEl, index - 1);
          setAnchor(nextEl, index + 1);
          if (counterEl) { counterEl.textContent = id; }
        }

        function onHashChange() {
          render(getIndexFromHash());
        }

        window.addEventListener('hashchange', onHashChange);
        // Initial render
        onHashChange();
      })();
    </script>
  </body>
</html>


